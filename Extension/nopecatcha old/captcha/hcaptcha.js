(()=>{var Ke=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)};var p=(t,e,n)=>(Ke(t,e,"read from private field"),n?n.call(t):e.get(t)),b=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)};var m=(t,e,n)=>(Ke(t,e,"access private method"),n);var z=chrome;var $t="https://api.nopecha.com";var x="https://www.nopecha.com",Ue="https://developers.nopecha.com",Lt="https://nopecha.com/api-reference/",gn={doc:{url:Ue,automation:{url:`${Ue}/guides/extension_advanced/#automation-build`}},ref:{url:Lt},api:{base:$t,recognition:"/v1/recognition",status:"/v1/status"},www:{url:x,annoucement:{url:`${x}/json/announcement.json`},demo:{url:`${x}/captcha`,hcaptcha:{url:`${x}/captcha/hcaptcha`},recaptcha:{url:`${x}/captcha/recaptcha`},funcaptcha:{url:`${x}/captcha/funcaptcha`},awscaptcha:{url:`${x}/captcha/awscaptcha`},textcaptcha:{url:`${x}/captcha/textcaptcha`},turnstile:{url:`${x}/captcha/turnstile`},perimeterx:{url:`${x}/captcha/perimeterx`},geetest:{url:`${x}/captcha/geetest`},lemincaptcha:{url:`${x}/captcha/lemincaptcha`}},manage:{url:`${x}/manage`},pricing:{url:`${x}/pricing`},setup:{url:`${x}/setup`}},discord:{url:`${x}/discord`},github:{url:`${x}/github`,release:{url:`${x}/github/release`}}};function Ye(t){let e=("56f6edc6a3a062849786fffdcf0404240468fe65e349e40f669f34ea818acece"+t).split("").map(n=>n.charCodeAt(0));return Ze(e)}var Qe=new Uint32Array(256);for(let t=256;t--;){let e=t;for(let n=8;n--;)e=e&1?3988292384^e>>>1:e>>>1;Qe[t]=e}function Ze(t){let e=-1;for(let n of t)e=e>>>8^Qe[e&255^n];return(e^-1)>>>0}async function C(t,e){let n=""+[+new Date,performance.now(),Math.random()],[o,a]=await new Promise(r=>{z.runtime.sendMessage([n,t,...e],s=>{r(s)})});if(o===Ye(n))return a}function se(){let t;return e=>t||(t=e().finally(()=>t=void 0),t)}var $,Ot=se();function et(){return Ot(async()=>($||($=await C("settings::get",[])),$))}function tt(t){$&&($={...$,...t},nt($))}function ce(){return $}function _(t){return new Promise(e=>setTimeout(e,t))}var ot=[];function Be(t,e){t.timedout=!1,ot.push(t);let n,o=setInterval(async()=>{await at(t,ce())||(clearTimeout(n),clearInterval(o))},400);e&&(n=setTimeout(()=>clearInterval(o),e),t.timedout=!0)}async function at(t,e){if(t.timedout)return!1;let n=t.condition(e);if(n===t.running())return!1;if(!n&&t.running())return t.quit(),!1;if(n&&!t.running()){for(;!t.ready();)await _(200);return t.start(),!1}}function nt(t){ot.forEach(e=>at(e,t))}function rt(){z.runtime.connect({name:"stream"}).onMessage.addListener(e=>{e.event==="settingsUpdate"&&tt(e.settings)})}function Ae(t){if(document.readyState!=="loading")setTimeout(t,0);else{let e;e=()=>{removeEventListener("DOMContentLoaded",e),t()},addEventListener("DOMContentLoaded",e)}}var Ln=se();function qt(){return!0}async function Nt(t){t.scrollIntoView({behavior:"instant",block:"nearest",inline:"nearest"}),await new Promise(e=>requestAnimationFrame(e))}function st(){let t=`verify_${Math.random().toString(36).slice(2)}`;return document.documentElement.setAttribute("data-frame-token",t),t}function ct(){document.documentElement.removeAttribute("data-frame-token")}var J=null,it=null;async function Ft(){if(J!==null)return J;clearTimeout(it),it=setTimeout(()=>{J=null},6e4),J=!1,await C("debugger::enable",[]);let t=st();try{await C("debugger::mouseCapable",[t])===!0&&(J=!0)}catch{}finally{ct()}return J}async function le(t,e,n,o,a,r){await C("debugger::enable",[]);let s=st();try{if(await C("debugger::mouse",[s,t,e,n,o,a,r])===!0)return!0}catch{}finally{ct()}return!1}async function He(t,e,n,o,a,r,s){await C("debugger::enable",[]),await Nt(t);let i=t.getBoundingClientRect();if(i.width===0||i.height===0)return!1;n=n??null,o=o??null;let c=n!==null?i.left+n:i.left+i.width/2,l=o!==null?i.top+o:i.top+i.height/2,u=4;if(n===null){let d=Math.floor((Math.random()-.5)*.5*Math.max(i.width-u*2,0));c+=d}if(o===null){let d=Math.floor((Math.random()-.5)*.5*Math.max(i.height-u*2,0));l+=d}return await le(e,c,l,a,r,s)}async function Wt(t,e,n,o,a,r){if(["focus","blur","click","pointerdown","pointerup","pointermove","pointerrawupdate","pointerover","pointerenter","mouseenter","mouseover","pointerout","pointerleave","mouseout","mouseleave"].includes(e))return!0;a=a??0;let c=["none","left","middle","right"][a]??"none";return e==="mousedown"?t===null?await le("mousePressed",n,o,c,1,r):await He(t,"mousePressed",n,o,c,1,r):e==="mouseup"?(c=c==="none"?"left":c,t===null?await le("mouseReleased",n,o,c,1,r):await He(t,"mouseReleased",n,o,c,1,r)):e==="mousemove"?t===null?await le("mouseMoved",n,o,c,0,r):await He(t,"mouseMoved",n,o,c,0,r):!1}function Gt(t,e,n,o,a){t===null&&(t=document.body),a=a??0,["pointerup","mouseup"].includes(e)&&a!==0&&(a=0);let r=null;if(e==="focus"){let s={bubbles:!1,cancelable:!1,view:window};r=new FocusEvent(e,s)}else if(e==="blur"){let s={bubbles:!1,cancelable:!1,view:window};r=new FocusEvent(e,s)}else if(e==="click"){let s={bubbles:!0,cancelable:!0,view:window,buttons:0,clientX:Math.floor(n),clientY:Math.floor(o),pointerId:1,pointerType:"mouse"};r=new PointerEvent(e,s)}else if(e.startsWith("mouse")){let s={bubbles:!0,cancelable:!0,view:window,buttons:a,clientX:Math.floor(n),clientY:Math.floor(o)};r=new MouseEvent(e,s)}else if(e.startsWith("pointer")){e==="pointerrawupdate"&&(n+=87.857,o+=10.571);let s={bubbles:!0,cancelable:!0,view:window,buttons:a,clientX:n+.2857360839844,clientY:o+.42857360839844,pointerId:1,pointerType:"mouse"};r=new PointerEvent(e,s)}else return!1;try{return t.dispatchEvent(r),!0}catch{return!1}}function jt(t){let e=typeof t=="string"?document.querySelector(t):t;return e||null}async function j(){return!!(qt()&&await Ft()===!0)}async function T(t,e,n,o,a,r,s){return s=s??await j(),!!(s&&await Wt(t,e,n,o,a,r)||Gt(t,e,n,o,a)===!0)}async function L(t,e,n){e=e??null,n=n??null;let o=e,a=n,r=null;if(t===null){if(e===null||n===null)return!1}else{if(r=jt(t),r===null)return!1;let c=r.getBoundingClientRect();o=e??c.width/2,a=n??c.height/2;let l=4;if(e===null){let u=Math.floor((Math.random()-.5)*.5*Math.max(c.width-l*2,0));o+=u}if(n===null){let u=Math.floor((Math.random()-.5)*.5*Math.max(c.height-l*2,0));a+=u}}let s=[{name:"pointerrawupdate",buttons:0,delayMs:0},{name:"pointerover",buttons:0,delayMs:0},{name:"pointerenter",buttons:0,delayMs:0},{name:"mouseover",buttons:0,delayMs:0},{name:"mouseenter",buttons:0,delayMs:10},{name:"pointermove",buttons:0,delayMs:0},{name:"mousemove",buttons:0,delayMs:10},{name:"pointerrawupdate",buttons:0,delayMs:0},{name:"pointermove",buttons:0,delayMs:0},{name:"mousemove",buttons:0,delayMs:30},{name:"focus",buttons:0,delayMs:0},{name:"pointerdown",buttons:1,delayMs:0},{name:"mousedown",buttons:1,delayMs:30},{name:"pointerup",buttons:0,delayMs:0},{name:"mouseup",buttons:0,delayMs:0},{name:"click",buttons:0,delayMs:0}],i=[];for(let{name:c,buttons:l,delayMs:u}of s){let d=await T(r,c,o,a,l);i.push(d),u&&await _(u)}return i.every(c=>c)}var Xt=2e3,ue,$e=!1;function lt(){return!!(document.querySelector("div.check")&&document.querySelector("#anchor"))}async function ut(){$e=!0;let t=null,e=null;for(;t===null&&(t=document.querySelector("#anchor"),t===null);)await _(1e3);for(;e===null&&(e=document.querySelector("div.check"),e===null);)await _(1e3);let n=null,o=()=>{clearTimeout(n),n=window.setTimeout(()=>{let a=document.querySelector("div.pulse"),r=document.querySelector("#checkbox");t?.getAttribute("aria-hidden")==="true"||e?.style?.display==="block"||a?.style?.display==="block"||r?.getAttribute("tabindex")==="-1"||Vt()},Xt)};ue=new MutationObserver(o),ue.observe(e,{attributes:!0}),ue.observe(t,{attributes:!0}),o()}function dt(){ue.disconnect(),$e=!1}function mt(){return $e}var De=!1;async function Vt(){if(!De){De=!0;try{await _(500),await L("#checkbox")}catch{}finally{De=!1}}}function Le(){return[]}function oe(t,e){return new Promise((n,o)=>{t.push(n),e&&setTimeout(()=>{o(new Error("Signal wait timeout"))},e)})}function K(t){t.forEach(e=>e()),t.splice(0)}function Oe(t){return new Promise((e,n)=>{let o=new FileReader;o.onload=()=>e(o.result),o.onerror=()=>n(new Error("filereader")),o.readAsDataURL(t)})}var Fe,zt,he,pt,V=class{static blob_to_data_url(e){return new Promise((n,o)=>{let a=new FileReader;a.onload=()=>n(a.result),a.onerror=()=>o(new Error("filereader")),a.readAsDataURL(e)})}static display(...e){return new Promise(async(n,o)=>{let a=[],r=null;for(let i of e)if(r===null&&typeof i=="string"&&/^data:/.test(i))r=i;else if(r===null&&i instanceof Blob)r=await V.blob_to_data_url(i);else if(r===null&&(i instanceof HTMLImageElement||i instanceof HTMLVideoElement))r=i.src;else if(r===null&&i instanceof ImageBitmap){let c=new OffscreenCanvas(i.width,i.height),l=c.getContext("2d");if(!l)return o(new Error("offscreen canvas failed to get 2d context"));l.drawImage(i,0,0);let u=await c.convertToBlob();r=await V.blob_to_data_url(u)}else if(r===null&&i instanceof ImageData){let c=new OffscreenCanvas(i.width,i.height),l=c.getContext("2d");if(!l)return o(new Error("offscreen canvas failed to get 2d context"));l.putImageData(i,0,0);let u=await c.convertToBlob();r=await V.blob_to_data_url(u)}else if(r===null&&i instanceof HTMLCanvasElement)try{r=i.toDataURL()}catch{let l=await new Promise((u,d)=>{i.toBlob(f=>{f?u(f):d(new Error("canvas toBlob failed"))})});r=await V.blob_to_data_url(l)}else if(r===null&&i instanceof OffscreenCanvas){let c=await i.convertToBlob();r=await V.blob_to_data_url(c)}else a.push(i);if(r){let i=r.match(/^data:([^;]+);base64,(.+)$/);if(i){let c=[],l=i[1],u=i[2],d=u.length*3/4-(u.endsWith("==")?2:u.endsWith("=")?1:0);c.push("mime: ".padStart(16)+`${l}
`),c.push("size: ".padStart(16)+`${m(this,he,pt).call(this,d)}
`);let f=0;await new Promise((v,M)=>{let S=new Image;S.onload=()=>{c.push("dim: ".padStart(16)+`${S.naturalWidth}x${S.naturalHeight}
`),f=S.naturalWidth,v(!0)},S.onerror=A=>{M(new Error("image load failed"))},S.src=r});let w=c.reduce((v,M)=>Math.max(v,M.length),0),y=Math.max(0,Math.floor(f/7)-w+f%7-2);for(let v=0;v<c.length;v++)c[v]=`${" ".repeat(y)}${c[v]}`;let h=c.join(""),E=String.fromCharCode(27);a.unshift(E+"[1;33m"+h+E+"[0m")}}a.length===0&&a.push("(image)");for(let i=a.length-1;i>0;i--)typeof a[i]=="string"&&(a[0]=(a[0]||"")+a[i],a.splice(i,1));let s=new Image;if(s.onload=()=>{n(!0)},s.onerror=i=>{o(new Error("image load failed"))},!r)return o(new Error("no image data provided"));s.src=r})}},de=V;Fe=new WeakSet,zt=function(e,...n){let o={"font-size":"1px",padding:`${Math.floor(e.height/4)}px ${Math.floor(e.width/2)}px`,"line-height":`${e.height/2}px`,background:`url(${e.src}) no-repeat center`,"background-size":`${e.width}px ${e.height}px`};return[`%c+%c
%s`,Object.keys(o).map(a=>`${a}: ${o[a]}`).join("; "),"",...n]},he=new WeakSet,pt=function(e){let n=["B","KB","MB","GB","TB"],o=e,a=0;for(;o>=1024&&a<n.length-1;)o/=1024,a++;return`${o.toFixed(2)} ${n[a]}`},b(de,Fe),b(de,he);var q,ge,be,we,N,_e,ft,ye,ve,R,I,Ee,ht,xe,gt,B,O,H,X,Z,me,F,U,ee,pe,ae,qe,Ce,bt,te,fe,W,Y,re,Ne,ke,wt,Me,_t,Te,yt,G,Q,k,Se,vt,Re,Et,We=class{static async detect_media(e,{timeout_ms:n=1500,concurrency:o=4,prefer:a=null,candidates:r=null,return_all:s=!1}={}){if(typeof e!="string"||(e=e.trim()).length===0)throw new Error(`url must be a non-empty string, got: ${e}`);if(typeof n!="number"||!Number.isFinite(n)||Math.floor(n)!==n||n<1)throw new Error(`timeout_ms must be a positive integer, got: ${n}`);if(typeof o!="number"||!Number.isFinite(o)||Math.floor(o)!==o||o<1)throw new Error(`concurrency must be a positive integer, got: ${o}`);if(!["image","video",null].includes(a))throw new Error(`prefer must be 'image', 'video', or null, got: ${a}`);let i=Array.isArray(r)?r.filter(Boolean):null;if(i&&!i.length)throw new Error(`candidates must be a non-empty array of strings or null, got: ${r}`);let c=m(this,Ee,ht).call(this,e);if(c&&!s)return c;let l=m(this,Z,me).call(this,e);if(l&&p(this,q)[l]){let w=m(this,G,Q).call(this,e,{ext:l,from:"url"});return s||m(this,B,O).call(this,e,w),w}try{let w=await m(this,re,Ne).call(this,e,n,null);if(m(this,ee,pe).call(this,w.status)){let y=w.headers.get("content-type")||"";if(y){let h=m(this,G,Q).call(this,e,{mime:y,from:"head"});return s||m(this,B,O).call(this,e,h),h}}}catch{}let u=m(this,Me,_t).call(this,e,a,i),d=await m(this,Te,yt).call(this,e,u,{timeout_ms:n,concurrency:o,return_all:s});if(d.length){let w=d[0],y=m(this,G,Q).call(this,w.url,{ext:w.ext,mime:w.mime,from:"probe"});if(s){y.all=d.map(h=>({ext:h.ext,url:h.url,mime:h.mime})),m(this,B,O).call(this,e,y);for(let h of d)m(this,B,O).call(this,h.url,m(this,G,Q).call(this,h.url,{ext:h.ext,mime:h.mime,from:"probe"}))}else m(this,B,O).call(this,e,y),m(this,B,O).call(this,w.url,y);return y}let f=m(this,G,Q).call(this,e,{from:"unknown"});return s||m(this,B,O).call(this,e,f),f}static async url_to_data_uri(e,{timeout_ms:n=5e3,max_bytes:o=26214400,allow_canvas_image_fallback:a=!1,prefer:r="video",candidates:s=["webm","mp4"]}={}){if(typeof e!="string"||(e=e.trim()).length===0)return{ok:!1,code:p(this,k).INVALID_INPUT,tried:[]};if(e.startsWith("data:"))return{ok:!0,data_url:e,mime:e.slice(5).split(";")[0]||"",from:"as-is",tried:["as-is"]};let i=m(this,xe,gt).call(this,e);if(i)return i;if(e.startsWith("blob:"))try{let d=await(await m(this,W,Y).call(this,e,{method:"GET",cache:"no-store"},n)).blob();if(d.size>o)return m(this,H,X).call(this,e,{ok:!1,code:p(this,k).TOO_LARGE,tried:["blob"]});let f=await Oe(d);return m(this,H,X).call(this,e,{ok:!0,data_url:f,mime:d.type||"",from:"blob",tried:["blob"]})}catch{return m(this,H,X).call(this,e,{ok:!1,code:p(this,k).NETWORK,tried:["blob"]})}let c=[],l=null;try{l=await this.detect_media(e,{timeout_ms:Math.max(500,Math.floor(n*.6)),prefer:r,candidates:s}),l.ok&&l.url&&l.url!==e&&(e=l.url,c.push("detect-media"))}catch{}{let u=await m(this,Se,vt).call(this,e,{timeout_ms:n,max_bytes:o});if(c.push("content_fetch"+(u.ok?"":`:${u.code}`)),u.ok){let d=u.mime||l?.mime||"";if(m(this,ae,qe).call(this,{mime:d,data_url:u.data_url})){let f=m(this,F,U).call(this,d)||l?.ext||m(this,Z,me).call(this,e)||"";return m(this,H,X).call(this,e,{ok:!0,data_url:u.data_url,mime:d,ext:f,from:u.from,tried:c})}}}{let d=await C("fetch::asData",[e,{method:"GET",cache:"no-store",redirect:"follow",credentials:"omit"},n]);if(c.push("background_fetch"),d?.ok){let f=d.mime||l?.mime||"";if(m(this,ae,qe).call(this,{mime:f,data_url:d.data})){let w=m(this,F,U).call(this,f)||l?.ext||m(this,Z,me).call(this,e)||"";return m(this,H,X).call(this,e,{ok:!0,data_url:d.data,mime:f,ext:w,from:"background_fetch",tried:c})}}}if(a&&(l?.type==="image"||r==="image")){let u=await m(this,Re,Et).call(this,e,{timeout_ms:n});if(c.push("canvas_image"+(u.ok?"":`:${u.code}`)),u.ok)return m(this,H,X).call(this,e,{ok:!0,data_url:u.data_url,mime:u.mime||"image/png",ext:m(this,F,U).call(this,u.mime||"image/png")||"png",from:u.from,tried:c})}return{ok:!1,code:p(this,k).EXHAUSTED,tried:c}}},g=We;q=new WeakMap,ge=new WeakMap,be=new WeakMap,we=new WeakMap,N=new WeakMap,_e=new WeakSet,ft=function(e){try{return new URL(e,typeof window<"u"?window.location.href:"http://localhost").origin}catch{return""}},ye=new WeakMap,ve=new WeakMap,R=new WeakMap,I=new WeakMap,Ee=new WeakSet,ht=function(e){let n=p(this,R).get(e);return n?(p(this,R).delete(e),p(this,R).set(e,n),n):null},xe=new WeakSet,gt=function(e){let n=p(this,I).get(e);return n?(p(this,I).delete(e),p(this,I).set(e,n),n):null},B=new WeakSet,O=function(e,n){return p(this,R).has(e)&&p(this,R).delete(e),p(this,R).set(e,n),p(this,R).size>p(this,ye)&&p(this,R).delete(p(this,R).keys().next().value),n},H=new WeakSet,X=function(e,n){return p(this,I).has(e)&&p(this,I).delete(e),p(this,I).set(e,n),p(this,I).size>p(this,ve)&&p(this,I).delete(p(this,I).keys().next().value),n},Z=new WeakSet,me=function(e){let n=e.match(/\.([a-z0-9]+)(?:[\?#]|$)/i);return n?n[1].toLowerCase():""},F=new WeakSet,U=function(e){if(!e)return"";let n=p(this,ge).get(e);if(n)return n;if(e.startsWith("image/")){if(e.includes("webp"))return"webp";if(e.includes("avif"))return"avif";if(e.includes("svg"))return"svg";if(e.includes("png"))return"png";if(/jpe?g/.test(e))return"jpg";if(e.includes("gif"))return"gif";if(e.includes("tiff"))return"tiff"}else if(e.startsWith("video/")){if(e.includes("webm"))return"webm";if(e.includes("mp4"))return"mp4";if(e.includes("ogg"))return"ogv";if(e.includes("mpeg"))return"mpeg";if(e.includes("3gpp2"))return"3g2";if(e.includes("3gpp"))return"3gp";if(e.includes("mp2t"))return"ts";if(e.includes("x-msvideo"))return"avi"}else if(e.startsWith("audio/")){if(e.includes("mpeg"))return"mp3";if(e.includes("ogg"))return"oga";if(e.includes("aac"))return"aac";if(e.includes("wav"))return"wav";if(e.includes("webm"))return"weba"}else if(e==="application/pdf")return"pdf";return""},ee=new WeakSet,pe=function(e){return e>=200&&e<300},ae=new WeakSet,qe=function({mime:e=null,data_url:n=null}={}){if(e&&(e.startsWith("image/")||e.startsWith("video/")||e.startsWith("audio/")))return!0;if(n){let o=n.match(/^data:([^;]+);/);if(o){let a=o[1];return a.startsWith("image/")||a.startsWith("video/")||a.startsWith("audio/")}}return!1},Ce=new WeakSet,bt=function(e,n){if(!n)return!1;let o=m(this,F,U).call(this,n);if(!e)return!!o;if(o)return o===e;let a=p(this,q)[e];return a?n.startsWith(a.type+"/"):!0},te=new WeakSet,fe=function(e,n){if(!e)return;if(e.aborted){try{n.abort(e.reason||"upstream")}catch{}return}let o=()=>{try{n.abort(e.reason||"upstream")}catch{}e.removeEventListener("abort",o)};e.addEventListener("abort",o)},W=new WeakSet,Y=async function(e,n,o){let a=null,r=n&&n.signal?n.signal:null;if(typeof AbortSignal<"u"&&AbortSignal.timeout){let s=AbortSignal.timeout(o);return r?(a=new AbortController,m(this,te,fe).call(this,r,a),m(this,te,fe).call(this,s,a),r=a.signal):r=s,await fetch(e,{...n,signal:r})}else{a=new AbortController,m(this,te,fe).call(this,n&&n.signal,a);let s=setTimeout(()=>{try{a.abort("timeout")}catch{}},o);try{let i=await fetch(e,{...n,signal:a.signal});return clearTimeout(s),i}catch(i){throw clearTimeout(s),i}}},re=new WeakSet,Ne=async function(e,n,o){let a=m(this,_e,ft).call(this,e),r=p(this,N).get(a)||{block_head:!1,cors_opaque:!1},s={redirect:"follow",cache:"no-store"};if(r.block_head)try{let i=await m(this,W,Y).call(this,e,{...s,method:"GET",headers:{range:"bytes=0-0"},signal:o},Math.max(400,Math.floor(n*.9)));return typeof Response<"u"&&i.type==="opaque"&&p(this,N).set(a,{...r,cors_opaque:!0}),i}catch{throw new Error("range-failed")}try{let i=await m(this,W,Y).call(this,e,{...s,method:"HEAD",signal:o},n);return typeof Response<"u"&&i.type==="opaque"&&p(this,N).set(a,{...r,cors_opaque:!0}),i}catch{p(this,N).set(a,{...r,block_head:!0});try{let c=await m(this,W,Y).call(this,e,{...s,method:"GET",headers:{range:"bytes=0-0"},signal:o},Math.max(400,Math.floor(n*.9)));return typeof Response<"u"&&c.type==="opaque"&&p(this,N).set(a,{...r,cors_opaque:!0}),c}catch{throw new Error("range-failed")}}},ke=new WeakSet,wt=function(e,n){let o=new URL(e,typeof window<"u"?window.location.href:"http://localhost"),a=o.pathname.split("/"),r=a[a.length-1],s=r.match(/^([^\.]+)(\.[^\/\.]+)?$/);if(s){let i=s[1],c=s[2]?s[2].slice(1).toLowerCase():"";c&&p(this,q)[c]?a[a.length-1]=i+"."+n:a[a.length-1]=r+(r.endsWith(".")?"":".")+n}else a[a.length-1]=(r||"index")+"."+n;return o.pathname=a.join("/"),o.toString()},Me=new WeakSet,_t=function(e,n,o){if(o&&o.length)return o.slice();let a=p(this,be);if(n==="image")return a.slice();let r=p(this,we);return n==="video"?r.slice():e.includes("/tip/")||e.includes("hcaptcha")?["webm","mp4"]:[...a,...r]},Te=new WeakSet,yt=async function(e,n,{timeout_ms:o,concurrency:a,return_all:r}){let s=[],i=0,c=0,l=Number.POSITIVE_INFINITY,u=!1,d=null,f=()=>{r||u||Number.isFinite(l)&&(u=!0,d(!0))},w=async h=>{c+=1;let E=n[h],v=m(this,ke,wt).call(this,e,E);try{let M=await m(this,re,Ne).call(this,v,o,null);if(typeof Response<"u"&&M&&M.type==="opaque")return;if(M&&m(this,ee,pe).call(this,M.status)){let S=M.headers.get("content-type")||"";m(this,Ce,bt).call(this,E,S)&&(s.push({index:h,url:v,ext:E,mime:S}),!r&&h<l&&(l=h,f()))}}catch{}c-=1},y=async()=>{for(;i<n.length&&c<a;)w(i),i+=1;return r?c===0&&i>=n.length?!0:(await new Promise(h=>setTimeout(h,0)),await y()):Number.isFinite(l)||c===0&&i>=n.length?!0:(await new Promise(h=>setTimeout(h,0)),await y())};return r?await y():await Promise.race([new Promise(h=>{d=h}),y()]),s.sort((h,E)=>h.index-E.index),s},G=new WeakSet,Q=function(e,{ext:n="",mime:o="",from:a="unknown"}={}){let r=n||m(this,F,U).call(this,o)||"",s=r?p(this,q)[r]:null;return{ok:!!(r||o),url:e,ext:r,mime:o||(s?s.mime:""),type:s?s.type:o?o.split("/")[0]:"",kind:s?s.kind:"",from:a,all:void 0}},k=new WeakMap,Se=new WeakSet,vt=async function(e,{timeout_ms:n,max_bytes:o}){try{let a=await m(this,W,Y).call(this,e,{method:"GET",cache:"no-store",redirect:"follow",credentials:"omit"},n);if(typeof Response<"u"&&a.type==="opaque")return{ok:!1,code:p(this,k).OPAQUE};if(!m(this,ee,pe).call(this,a.status))return{ok:!1,code:p(this,k).NETWORK,status:a.status};let r=a.headers.get("content-length");if(r&&Number.isFinite(+r)&&+r>o)return{ok:!1,code:p(this,k).TOO_LARGE,size:+r};let s=await a.blob();if(s.size>o)return{ok:!1,code:p(this,k).TOO_LARGE,size:s.size};let i=await Oe(s),c=s.type||"";return{ok:!0,data_url:i,mime:c,from:"content_fetch"}}catch(a){return a&&(a.name==="TimeoutError"||a==="timeout")||(a?.message||"").includes("timeout")?{ok:!1,code:p(this,k).TIMEOUT}:{ok:!1,code:p(this,k).NETWORK}}},Re=new WeakSet,Et=async function(e,{timeout_ms:n,target_mime:o="image/png",quality:a=.92}){let r=new Image;r.crossOrigin="anonymous";let s=setTimeout(()=>{try{r.src=""}catch{}},n);try{await new Promise((f,w)=>{r.onload=()=>f(!0),r.onerror=()=>w(new Error("img-error")),r.src=e}),clearTimeout(s);let i=Math.max(1,r.naturalWidth||r.width||1),c=Math.max(1,r.naturalHeight||r.height||1),l=typeof OffscreenCanvas<"u"?new OffscreenCanvas(i,c):(()=>{let f=document.createElement("canvas");return f.width=i,f.height=c,f})(),u=l.getContext("2d",{alpha:!0});if(!u)return{ok:!1,code:p(this,k).UNSUPPORTED};u.drawImage(r,0,0,i,c);let d;try{d=l.convertToBlob?await(async()=>{let f=await l.convertToBlob({type:o,quality:a});return await Oe(f)})():l.toDataURL(o,a)}catch{return{ok:!1,code:p(this,k).CORS_TAINTED}}return{ok:!0,data_url:d,mime:o,from:"canvas_image"}}catch(i){return clearTimeout(s),i&&(i.name==="TimeoutError"||i==="timeout")?{ok:!1,code:p(this,k).TIMEOUT}:{ok:!1,code:p(this,k).NETWORK}}},b(g,_e),b(g,Ee),b(g,xe),b(g,B),b(g,H),b(g,Z),b(g,F),b(g,ee),b(g,ae),b(g,Ce),b(g,te),b(g,W),b(g,re),b(g,ke),b(g,Me),b(g,Te),b(g,G),b(g,Se),b(g,Re),b(g,q,{apng:{type:"image",mime:"image/apng",kind:"Animated Portable Network Graphics (APNG) image"},avif:{type:"image",mime:"image/avif",kind:"AVIF image"},bmp:{type:"image",mime:"image/bmp",kind:"Windows OS/2 Bitmap Graphics"},gif:{type:"image",mime:"image/gif",kind:"Graphics Interchange Format (GIF)"},ico:{type:"image",mime:"image/vnd.microsoft.icon",kind:"Icon format"},jpeg:{type:"image",mime:"image/jpeg",kind:"JPEG images"},jpg:{type:"image",mime:"image/jpeg",kind:"JPEG images"},png:{type:"image",mime:"image/png",kind:"Portable Network Graphics"},svg:{type:"image",mime:"image/svg+xml",kind:"Scalable Vector Graphics (SVG)"},tif:{type:"image",mime:"image/tiff",kind:"Tagged Image File Format (TIFF)"},tiff:{type:"image",mime:"image/tiff",kind:"Tagged Image File Format (TIFF)"},webp:{type:"image",mime:"image/webp",kind:"WEBP image"},"3g2":{type:"video",mime:"video/3gpp2",kind:"3GPP2 audio/video container"},"3gp":{type:"video",mime:"video/3gpp",kind:"3GPP audio/video container"},avi:{type:"video",mime:"video/x-msvideo",kind:"AVI: Audio Video Interleave"},mp4:{type:"video",mime:"video/mp4",kind:"MP4 video"},mpeg:{type:"video",mime:"video/mpeg",kind:"MPEG Video"},ogv:{type:"video",mime:"video/ogg",kind:"Ogg video"},ts:{type:"video",mime:"video/mp2t",kind:"MPEG transport stream"},webm:{type:"video",mime:"video/webm",kind:"WEBM video"}}),b(g,ge,(()=>{let e=new Map;for(let[n,o]of Object.entries(p(We,q)))e.set(o.mime,n);return e})()),b(g,be,["webp","avif","jpeg","jpg","png","gif","apng","bmp","svg"]),b(g,we,["webm","mp4","ogv","mpeg","3gp","3g2","ts","avi"]),b(g,N,new Map),b(g,ye,512),b(g,ve,64),b(g,R,new Map),b(g,I,new Map),b(g,k,Object.freeze({INVALID_INPUT:"invalid-input",TIMEOUT:"timeout",TOO_LARGE:"too-large",NETWORK:"network",OPAQUE:"opaque",CORS_TAINTED:"cors-tainted",UNSUPPORTED:"unsupported",EXHAUSTED:"exhausted"}));async function xt(t,e){let n={v:z.runtime.getManifest().version,key:Jt(t)};return n.url=await C("tab::getURL",[]),n}function Jt(t){return!t.keys||!t.keys.length?t.key:t.keys[Math.floor(Math.random()*t.keys.length)]}var Ge="4093804980";var ne=Le(),Ve=Le(),ie,P=!1,D=[];window.addEventListener("message",t=>{if(t.source!==window||!t.data||t.data.source!==Ge)return;let e=t.data;Qt(e.payload)});function Ct(){let t=document.querySelector(".challenge-container");return!(!t||t.childElementCount===0||!document.querySelector(".display-error")||!document.querySelector("body.no-selection")||!document.querySelector("div.button-submit.button"))}function kt(){P=!0,K(ne),D.splice(0,D.length-1),ie&&ie.disconnect(),ie=new MutationObserver(()=>{K(ne)});let t=[[document.querySelector(".challenge-container"),{childList:!0,subtree:!0}],[document.querySelector(".display-error"),{attributes:!0,attributeFilter:["aria-hidden"]}],[document.querySelector("body.no-selection"),{attributes:!0,attributeFilter:["aria-hidden"]}],[document.querySelector("div.button-submit.button"),{attributes:!0,attributeFilter:["style","class"]}]];for(let[e,n]of t)if(e)try{ie.observe(e,n)}catch{}Ut()}function Mt(){ie?.disconnect(),P=!1,D.length=0,K(ne),K(Ve)}function Tt(){return P}async function Kt(){document.querySelector("#display-language .text, .display-language .text")?.textContent!=="EN"&&(await L(".language-selector .option:nth-child(23)"),await St())}async function ze(){await L(".button-submit")}async function St(){await L(".refresh")}var je=!1;async function Ut(){if(je)return;je=!0;let t;for(;P;){if(document.querySelector(".display-error[aria-hidden=false]"))for(;P&&document.querySelector(".button-submit[title*=Submit], .button-submit[title*=Verify]");)await _(1e3);if(!document.querySelector(".challenge-container")?.childElementCount){await _(1e3);continue}if(await Kt(),t=t??await tn(),!t)break;let e=Date.now(),n=await nn(t);if(!n){t=void 0,await _(1e3);continue}let o=ce(),a=await xt(o),r=await C("api::recognition",[{...a,type:"hcaptcha",data:n}]);if(!r||"error"in r){await _(2e3);continue}if(!await rn(o,e,n,r)){St(),t=void 0,await _(3e3);continue}await _(1e3),t=void 0}je=!1}var Yt=4,Rt=15e3,Ie=new Map;function Qt(t){if(!t||typeof t.body!="string")return;let e;try{e=JSON.parse(t.body)}catch{return}if(!e||typeof e!="object"||!Zt(e.request_type))return;let n=e.key||e.request_id||e.req;if(n){let o=Ie.get(n);if(o&&Date.now()-o<Rt)return;Ie.set(n,Date.now()),en()}for(D.push({raw:e,receivedAt:Date.now()});D.length>Yt;)D.shift();K(Ve)}function Zt(t){return t==="image_label_binary"||t==="image_label_area_select"||t==="image_drag_drop"}function en(){for(let[t,e]of Ie.entries())Date.now()-e>Rt&&Ie.delete(t)}async function tn(){for(;P;){if(D.length){let t=D.pop();if(D.length=0,t)return t}await oe(Ve)}}async function nn(t){if(t.prepared)return t.prepared;if(!t.preparing){let e=JSON.parse(JSON.stringify(t.raw));t.preparing=on(e).then(n=>(n._timestamp=Date.now(),n._url=window.location.href,n._platform=navigator?.platform,n._user_agent=navigator?.userAgent,n._language=navigator?.language,t.prepared=n,n))}return t.preparing}async function on(t){return await Xe(t),t}var an=/https?:\/\/[^\s"'`<>()]+/gi;async function Xe(t){if(!t)return t;if(typeof t=="string"){if(t.startsWith("data:"))return t;let e=t.match(an);if(!e)return t;let n=t;for(let o of e){let a=o;try{let r=await g.url_to_data_uri(o);r.ok&&r.data_url&&(a=r.data_url)}catch{}n=n.split(o).join(a)}return n}if(Array.isArray(t)){for(let e=0;e<t.length;e++)t[e]=await Xe(t[e]);return t}if(typeof t=="object")for(let e of Object.keys(t))t[e]=await Xe(t[e]);return t}async function rn(t,e,n,o){let a=Array.isArray(o.data)?o.data:[];if(!a.length)return!1;switch(n.request_type){case"image_label_binary":return await sn(t,e,n,a);case"image_label_area_select":return await ln(t,e,n,a);case"image_drag_drop":return await un(t,e,n,a);default:return!1}}async function sn(t,e,n,o){let r=(n.tasklist||[]).reduce((s,i,c)=>{let l=Math.floor(c/9);return s[l]||(s[l]=[]),s[l].push(i),s},[]);for(let[s,i]of o.entries()){if(!P||!Array.isArray(i)||i.length!==9||!await Je())return!1;let c=await dn();if(!c)return!1;if(t.hcaptcha_solve_delay&&t.hcaptcha_solve_delay_time>0){let l=Date.now()-e,u=t.hcaptcha_solve_delay_time-l;u>0&&await _(u),e=Date.now()}for(let[l,u]of c.entries()){let d=u.getAttribute("aria-pressed")==="true";!!i[l]!==d&&(await L(`.task:nth-child(${l+1})`),await j()||await _(100+Math.random()*100))}ze();try{await oe(ne,1e4),await _(1e3)}catch{return!1}}return!0}async function cn(t){return new Promise((e,n)=>{let o=new Image;o.onload=()=>e(o),o.onerror=a=>n(new Error("image load failed: "+a)),o.src=t})}async function It(t){try{let e=await cn(t),n=e.naturalWidth||e.width,o=e.naturalHeight||e.height;return n/o}catch{return 0}}async function ln(t,e,n,o){for(let[a,r]of o.entries()){if(!P)return!1;n.tasklist=n.tasklist||[];let s=n.tasklist[a];if(!s)continue;if(!await Je())return!1;let i=await Pt();if(!i)return!1;if(t.hcaptcha_solve_delay&&t.hcaptcha_solve_delay_time>0){let l=Date.now()-e,u=t.hcaptcha_solve_delay_time-l;u>0&&await _(u),e=Date.now()}let c=await It(s.datapoint_uri);for(let l of r||[]){let u=typeof l.x=="number"?l.x:50,d=typeof l.y=="number"?l.y:50;await mn(i,u,d,c),await j()||await _(100+Math.random()*100)}ze();try{await oe(ne,1e4),await _(1e3)}catch{return!1}}return!0}async function un(t,e,n,o){for(let[a,r]of o.entries()){if(!P)return!1;n.tasklist=n.tasklist||[];let s=n.tasklist[a];if(!s)continue;if(!await Je())return!1;let i=await Pt();if(!i)return!1;await _(500);let c=await It(s.datapoint_uri);for(let l of r||[]){let u=n.tasklist?.flatMap(Pe=>Pe.entities||[]).find(Pe=>Pe.entity_id===l.entity_id);if(!u)continue;let{w:d,h:f,pl:w,pt:y,mt:h,isMobile:E}=Bt(i,c),v=0;E?v=-7:v=-14;let M=480,S=330,A=[u.coords[0]/M*d,u.coords[1]/S*f],Ht=A[0]+w,Dt=A[1]+y+h+v;await pn(i,Ht,Dt,l.x,l.y,c),await j()||await _(100+Math.random()*100)}if(t.hcaptcha_solve_delay&&t.hcaptcha_solve_delay_time>0){let l=Date.now()-e,u=t.hcaptcha_solve_delay_time-l;u>0&&await _(u),e=Date.now()}ze();try{await oe(ne,1e4),await _(1e3)}catch{return!1}}return!0}async function Je(t=3e4){let e=Date.now()+t;for(;Date.now()<e&&P;){if(document.querySelector(".button-submit.button")?.getAttribute("aria-disabled")==="false")return!0;await _(100)}return!1}async function dn(t=1e4){let e=Date.now()+t;for(;Date.now()<e&&P;){let n=[...document.querySelectorAll(".task-grid .task, .task")].filter(o=>o.querySelector(".task-image, .image"));if(n.length>=9)return n.slice(0,9);await _(100)}return null}async function Pt(t=1e4){let e=Date.now()+t;for(;Date.now()<e&&P;){let n=document.querySelector(".challenge-view > canvas");if(n)return n;await _(100)}return document.querySelector(".challenge-view > canvas")}function Bt(t,e=0,n=20){let o=t.getBoundingClientRect(),a=o.width/t.width,r=o.width<500,i=t.previousElementSibling?.getBoundingClientRect(),c=0;if(c+=i?.top||10,c<90){let v=i?.bottom||0;v>=100?c+=v:c+=r?100:120}let l=Math.round(c-o.top),u=document.querySelector(".example-image");u&&(l+=Math.round(u.getBoundingClientRect().height));let d=Math.round(n*a),f=Math.round(n*a),w=Math.round(n*a),y=Math.round(n*a);if(e>0)if((o.width-d-f)/e>o.height-l-w-y){let A=(o.height-l-w-y)*e;d=Math.round((o.width-A)/2),f=Math.round((o.width-A)/2)}else{let A=(o.width-d-f)/e;w=Math.round((o.height-l-A)/2),y=Math.round((o.height-l-A)/2)}let h=Math.round(o.width-d-f),E=Math.round(o.height-w-y-l);return{isMobile:r,w:h,h:E,pl:d,pr:f,pt:w,pb:y,mt:l}}function At(t,e,n,o=0){let{w:a,h:r,pl:s,pt:i,mt:c}=Bt(t,o),l=5;e=Math.max(l,Math.min(100-l,e)),n=Math.max(l,Math.min(100-l,n));let u=s+e/100*a,d=c+i+n/100*r;return[u,d]}async function mn(t,e,n,o=0){let a=At(t,e,n,o);if(!a)return;let[r,s]=a;if(await j()||(r+=10,s+=10),await L(t,r,s),!1)try{}catch(v){}}async function pn(t,e,n,o,a,r=0){let s=[e,n],i=At(t,o,a,r);if(await T(t,"pointerrawupdate",s[0],s[1],0),await T(t,"pointermove",s[0],s[1],0),await T(t,"mousemove",s[0],s[1],0),await _(30),await T(t,"focus",s[0],s[1],0),await T(t,"pointerdown",s[0],s[1],1),await T(t,"mousedown",s[0],s[1],1),await _(2500+Math.random()*500),!await j()){let d=Math.hypot(i[0]-s[0],i[1]-s[1]),f=Math.min(50,Math.ceil(d/10)),w=Math.max(1,500/f);for(let y=1;y<=f;y++){let h=y/f,E=s[0]+(i[0]-s[0])*h,v=s[1]+(i[1]-s[1])*h;await T(t,"pointerrawupdate",E,v,1),await T(t,"pointermove",E,v,1),await T(t,"mousemove",E,v,1),await _(w)}}if(await T(t,"pointerup",i[0],i[1],0),await T(t,"mouseup",i[0],i[1],0,"linear"),await T(t,"click",i[0],i[1],0),!1)try{}catch(M){}}async function fn(){rt(),await et(),await C("tab::registerDetectedCaptcha",["hcaptcha"]);let t=new URLSearchParams(location.hash.substring(1)),e=t.get("frame"),n=t.get("host");e==="checkbox"?Be({name:"hcaptcha/auto-open",condition:o=>o.enabled&&o.hcaptcha_auto_open&&!o.disabled_hosts.includes(n),ready:lt,start:ut,quit:dt,running:mt}):Be({name:"hcaptcha/auto-solve",condition:o=>o.enabled&&o.hcaptcha_auto_solve&&!o.disabled_hosts.includes(n),ready:Ct,start:kt,quit:Mt,running:Tt})}Ae(fn);})();
